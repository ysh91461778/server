<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>íŒŒì¼ ê´€ë¦¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css">
  <style>
    :root{ --line:#324255; --muted:#94a3b8; --accent:#3b82f6; --accent-opaque:rgba(59,130,246,.14); }
    body{ margin:0 }
    header{ display:flex; align-items:center; gap:10px; padding:12px 16px; border-bottom:1px solid var(--line) }
    .top-right{ margin-left:auto; display:flex; align-items:center; gap:8px }
    .pill{ background:#1f2937;color:#cbd5e1;border-radius:999px;padding:2px 8px }

    /* í† ê¸€ ë²„íŠ¼ */
    .theme-btn{
      border:1px solid var(--line);
      background:transparent;
      color:inherit;
      border-radius:999px;
      padding:6px 10px;
      font-size:14px;
      cursor:pointer;
    }

    main.fm{
      display:grid; grid-template-columns: 280px minmax(600px,1fr) 420px;
      gap:12px; padding:12px; align-items:stretch; min-height:calc(100vh - 60px);
    }
    @media (max-width:1100px){ main.fm{ grid-template-columns:240px 1fr 360px } }
    @media (max-width:900px){  main.fm{ grid-template-columns:1fr } }

    .card{ background:var(--card-dark); border:1px solid var(--line); border-radius:12px; padding:12px; display:flex; flex-direction:column; min-height:0 }
    body:not(.dark) .card{ background:var(--card-light) }

    #tree{ max-height:calc(100vh - 170px); overflow:auto; font-size:14px }
    .tree-row{ padding:4px 6px; border-radius:6px; cursor:pointer }
    .tree-row.sel div{ background:var(--accent-opaque) }
    .tree-row .drop-target{ outline:2px solid var(--accent); border-radius:6px }

    .dropzone{ border:2px dashed var(--line); border-radius:12px; padding:16px; text-align:center; margin-bottom:8px }
    .dropzone.drag{ border-color:var(--accent) }
    .bar{ display:flex; justify-content:space-between; align-items:center; gap:10px; margin:6px 0 10px }
    #list{ overflow:auto }
    table{ width:100%; border-collapse:collapse }
    th,td{ padding:8px; border-bottom:1px solid var(--line) }
    .right{ text-align:right }
    #list tbody tr.sel{ background:rgba(59,130,246,.1) }

    .btn{ border:none; background:#334155; color:#e5e7eb; border-radius:8px; padding:4px 8px; cursor:pointer }
    .btn.primary{ background:#2563eb; color:#fff }
    .btn.ghost{ background:transparent; border:1px solid var(--line) }
    .btn.small{ padding:3px 7px; font-size:12px }

    .seg{ display:flex; gap:6px; background:transparent; border:1px solid var(--line); border-radius:9px; padding:2px }
    .seg .segbtn{ border:none; background:transparent; color:inherit; padding:6px 10px; border-radius:7px; cursor:pointer }
    .seg .segbtn.on{ background:var(--accent-opaque); color:#cfe1ff }

    .assign{ gap:10px }
    .assign .box{ border:1px solid var(--line); border-radius:10px; padding:8px }
    .lbl{ font-size:12px; opacity:.85; display:block; margin-bottom:4px }
    .chips{ display:flex; gap:6px; flex-wrap:wrap }
    .chip{ border:1px solid var(--line); border-radius:999px; padding:4px 10px; display:inline-flex; gap:6px; align-items:center; cursor:pointer }
    .chip input{ margin:0 }
    .two{ display:grid; grid-template-columns:1fr 1fr; gap:8px }
    .list{ max-height:220px; overflow:auto; display:grid; grid-template-columns:1fr 1fr; gap:6px }
    .list > label{ border:1px solid var(--line); border-radius:8px; padding:6px; display:flex; gap:8px; align-items:flex-start }
    .muted{ opacity:.7 }
    #amMatList.drop-target{ outline:2px dashed var(--accent); border-radius:10px }
    #amCurList{ grid-template-columns:1fr }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë¼ì´íŠ¸ ëª¨ë“œ ëŒ€ì‘ ì¶”ê°€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    body:not(.dark){
      --bg:#f8fafc;
      --card-light:#ffffff;
      --text:#0f172a;
      --line:#cbd5e1;
      --accent:#3b82f6;
      --accent-opaque:rgba(59,130,246,.12);
      --muted:#64748b;
    }

    /* ì¹´ë“œ ë°°ê²½ ë° í…Œë‘ë¦¬ */
    body:not(.dark) .card{
      background:var(--card-light);
      border-color:var(--line);
      color:var(--text);
      box-shadow:0 4px 14px rgba(0,0,0,.05);
    }

    /* í—¤ë” */
    body:not(.dark) header{
      background:#ffffff;
      border-bottom:1px solid var(--line);
      color:var(--text);
    }

    /* pill */
    body:not(.dark) .pill{
      background:#e2e8f0;
      color:#0f172a;
    }

    /* ë²„íŠ¼ */
    body:not(.dark) .btn{
      background:#e2e8f0;
      color:#0f172a;
      border:1px solid #cbd5e1;
    }
    body:not(.dark) .btn.primary{
      background:var(--accent);
      color:#fff;
      border:none;
    }
    body:not(.dark) .btn.ghost{
      background:transparent;
      border:1px solid var(--line);
      color:#1e293b;
    }

    /* ë“œë¡­ì¡´ */
    body:not(.dark) .dropzone{
      border-color:var(--line);
      background:#f1f5f9;
      color:#1e293b;
    }
    body:not(.dark) .dropzone.drag{
      border-color:var(--accent);
      background:var(--accent-opaque);
    }

    /* í…Œì´ë¸” */
    body:not(.dark) table{
      color:#0f172a;
    }
    body:not(.dark) th{
      background:#f1f5f9;
      border-bottom:1px solid var(--line);
    }
    body:not(.dark) tr:hover td{
      background:rgba(59,130,246,.06);
    }

    /* ì„ íƒ ìƒíƒœ */
    body:not(.dark) #list tbody tr.sel{
      background:rgba(59,130,246,.14);
    }

    /* ì„¸ê·¸ë¨¼íŠ¸ ë²„íŠ¼ */
    body:not(.dark) .seg{
      border-color:var(--line);
    }
    body:not(.dark) .seg .segbtn.on{
      background:var(--accent-opaque);
      color:#1e40af;
    }

    /* ì¹© */
    body:not(.dark) .chip{
      border-color:var(--line);
      background:#f8fafc;
      color:#1e293b;
    }

    /* ì˜¤ë¥¸ìª½ íŒ¨ë„ ë°•ìŠ¤ */
    body:not(.dark) aside.card.assign .box{
      background:#f9fafb;
      border:1px solid #e2e8f0;
    }

    /* í…ìŠ¤íŠ¸ ë³´ì¡°ìƒ‰ */
    body:not(.dark) .muted{
      color:#64748b;
      opacity:1;
    }

    /* ë“œë¡­ ëŒ€ìƒ í‘œì‹œ */
    body:not(.dark) #amMatList.drop-target{
      outline:2px dashed var(--accent);
    }
  </style>
</head>
<body class="dark fm-page">
  <header>
    <h1 style="margin:0;font-size:18px">íŒŒì¼ ê´€ë¦¬</h1>
    <span id="curPath" class="pill">/</span>

    <div class="top-right">
      <button id="themeToggle" class="theme-btn" aria-label="í…Œë§ˆ ì „í™˜">ğŸŒ™</button>
    </div>

    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <input id="newFolderName" placeholder="ìƒˆ í´ë”ëª…">
      <button id="btnMake"   class="btn">í´ë” ìƒì„±</button>
      <button id="btnRename" class="btn">ì´ë¦„ ë³€ê²½</button>
      <button id="btnMove"   class="btn">ì„ íƒ ì´ë™</button>
      <button id="btnDelete" class="btn">ì„ íƒ ì‚­ì œ</button>
    </div>
  </header>

  <main class="fm">
    <!-- ì¢Œ: íŠ¸ë¦¬ -->
    <aside class="card">
      <div style="display:flex;gap:8px;margin-bottom:8px">
        <button id="btnRefresh" class="btn">ìƒˆë¡œê³ ì¹¨</button>
      </div>
      <div id="tree"></div>
    </aside>

    <!-- ê°€ìš´ë°: íŒŒì¼ -->
    <section class="card">
      <div class="dropzone" id="drop">
        ì´ ì˜ì—­ìœ¼ë¡œ íŒŒì¼ì„ ë“œë˜ê·¸Â·ë“œë¡­í•˜ê±°ë‚˜
        <input type="file" id="fileInput" multiple style="display:inline-block">
        <button id="btnUpload" class="btn">ì—…ë¡œë“œ</button>
      </div>

      <div class="bar">
        <div>
          ì •ë ¬:
          <select id="sortSel" disabled>
            <option>í‘œ í—¤ë”(ì´ë¦„/í¬ê¸°/ìˆ˜ì •) í´ë¦­</option>
          </select>
        </div>
        <div class="muted">íŒŒì¼ í–‰ì„ ì²´í¬/ë“œë˜ê·¸ ì„ íƒ â†’ ìš°í´ë¦­: ì´ë¦„ë³€ê²½/ì´ë™/ì‚­ì œ/ë°°ì • ë‹´ê¸°</div>
      </div>

      <div id="list"></div>
    </section>

    <!-- ìš°: ë°°ì • íŒ¨ë„ -->
    <aside class="card assign">
      <div class="box">
        <div class="lbl">ëª¨ë“œ</div>
        <div class="seg">
          <button id="modeAdd" class="segbtn on">â• ì¶”ê°€(ë°°ì •)</button>
          <button id="modeRemove" class="segbtn">â– í•´ì œ(ë¹¼ê¸°)</button>
        </div>
      </div>

      <div class="box">
        <div class="lbl">ì»¤ë¦¬í˜ëŸ¼</div>
        <select id="amCur"></select>
      </div>

      <div class="two">
        <div class="box">
          <div class="lbl">ì„¸ë¶€ ì»¤ë¦¬í˜ëŸ¼</div>
          <select id="amSub"><option value="">(ì „ì²´)</option></select>
        </div>
        <div class="box">
          <div class="lbl">ë ˆë²¨(ë³µìˆ˜)</div>
          <div id="amLvWrap" class="chips"></div>
          <button id="amLvAll" class="btn small" style="margin-top:6px">ë ˆë²¨ ì „ì²´</button>
        </div>
      </div>

      <div class="box">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
          <b>ëŒ€ìƒ í•™ìƒ <span id="amStuCount" class="muted">(0ëª…)</span></b>
        </div>
        <div id="amStuList" class="list" style="grid-template-columns:1fr"></div>
      </div>

      <!-- ì¶”ê°€(ë°°ì •) -->
      <div class="box" id="boxAdd">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
          <b>ë°°ì •í•  ìë£Œ(ë“œë˜ê·¸Â·ë“œë¡­)</b>
          <div><button id="amPickClear" class="btn small ghost">ë¹„ìš°ê¸°</button></div>
        </div>
        <div id="amMatList" class="list"></div>
      </div>

      <!-- í•´ì œ(ë¹¼ê¸°) -->
      <div class="box" id="boxRemove" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
          <b>í˜„ì¬ ë°°ì •ëœ ìë£Œ(í•©ì§‘í•©)</b>
          <div>
            <button id="rmAll" class="btn small">ì „ì²´ì„ íƒ</button>
            <button id="rmNone" class="btn small ghost">í•´ì œ</button>
          </div>
        </div>
        <div id="amCurList" class="list"></div>
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="amDoAssign" class="btn primary">ì‹¤í–‰</button>
      </div>
    </aside>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js" defer></script>
  <script type="module" src="/js/file-manage.js"></script>

  <script>
    // â”€â”€ í…Œë§ˆ ì´ˆê¸°í™”
    (function initTheme(){
      try{
        const saved = localStorage.getItem('theme'); // 'dark' | 'light'
        if (saved === 'light') document.body.classList.remove('dark');
        else document.body.classList.add('dark'); // ê¸°ë³¸ ë‹¤í¬
      }catch{}
      updateThemeIcon();
    })();

    // â”€â”€ í† ê¸€ ë²„íŠ¼
    const btn = document.getElementById('themeToggle');
    btn.addEventListener('click', ()=>{
      const isDark = document.body.classList.toggle('dark');
      try{ localStorage.setItem('theme', isDark ? 'dark' : 'light'); }catch{}
      updateThemeIcon();
    });

    function updateThemeIcon(){
      const isDark = document.body.classList.contains('dark');
      const el = document.getElementById('themeToggle');
      if (el) el.textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
      // í—¤ë”/ë²„íŠ¼ ëŒ€ë¹„ ìœ ì§€(ë¼ì´íŠ¸ì—ì„œ ë” ì„ ëª…)
      document.documentElement.style.setProperty('--line', isDark ? '#324255' : '#cbd5e1');
    }
  </script>
</body>
</html>
